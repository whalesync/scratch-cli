#
# Custom roles
#
# Instead of using default roles, Vanta prefers it if we use custom roles with limited permissions.
#

## ---------------------------------------------------------------------------------------------------------------------
## IAM Default Service Accounts - Remove Default Roles
## ---------------------------------------------------------------------------------------------------------------------

resource "google_project_iam_custom_role" "compute_engine_service_account_role" {
  count       = local.ready_to_deploy_iam ? 1 : 0
  role_id     = "computeEngineServiceAccountCustomRole"
  title       = "CE Custom Default Service Account Role"
  description = "Custom Role for the Compute Engine default service account"
  permissions = [
    "logging.logEntries.create",
    "monitoring.timeSeries.create",
    "cloudkms.cryptoKeyVersions.useToDecrypt",
    "cloudkms.cryptoKeyVersions.useToEncrypt",
    "cloudkms.locations.get",
    "cloudkms.locations.list",
    "resourcemanager.projects.get",
  ]
}

resource "google_project_iam_member" "compute_engine_service_assign_role" {
  count   = local.ready_to_deploy_iam ? 1 : 0
  project = var.gcp_project_id
  role    = "projects/${var.gcp_project_id}/roles/${google_project_iam_custom_role.compute_engine_service_account_role[0].role_id}"
  member  = "serviceAccount:${var.gcp_project_number}-compute@developer.gserviceaccount.com"
}

resource "google_project_iam_custom_role" "cloud_run_service_account_role" {
  count       = local.ready_to_deploy_iam ? 1 : 0
  role_id     = "cloudRunServiceAccountCustomRole"
  title       = "CR Custom Default Service Account Role"
  description = "Custom Role for the Cloud Run default service account"
  permissions = [
    "aiplatform.endpoints.predict",
    "artifactregistry.dockerimages.get",
    "artifactregistry.dockerimages.list",
    "artifactregistry.files.download",
    "artifactregistry.files.get",
    "artifactregistry.files.list",
    "artifactregistry.locations.get",
    "artifactregistry.locations.list",
    "artifactregistry.mavenartifacts.get",
    "artifactregistry.mavenartifacts.list",
    "artifactregistry.npmpackages.get",
    "artifactregistry.npmpackages.list",
    "artifactregistry.packages.get",
    "artifactregistry.packages.list",
    "artifactregistry.projectsettings.get",
    "artifactregistry.pythonpackages.get",
    "artifactregistry.pythonpackages.list",
    "artifactregistry.repositories.downloadArtifacts",
    "artifactregistry.repositories.get",
    "artifactregistry.repositories.list",
    "artifactregistry.repositories.listEffectiveTags",
    "artifactregistry.repositories.listTagBindings",
    "artifactregistry.repositories.readViaVirtualRepository",
    "artifactregistry.tags.get",
    "artifactregistry.tags.list",
    "artifactregistry.versions.get",
    "artifactregistry.versions.list",
    "cloudkms.cryptoKeyVersions.useToDecrypt",
    "cloudkms.cryptoKeyVersions.useToEncrypt",
    "cloudkms.locations.get",
    "cloudkms.locations.list",
    "cloudsql.instances.connect",
    "cloudsql.instances.get",
    "compute.acceleratorTypes.get",
    "compute.acceleratorTypes.list",
    "compute.addresses.createInternal",
    "compute.addresses.deleteInternal",
    "compute.addresses.get",
    "compute.addresses.list",
    "compute.addresses.use",
    "compute.addresses.useInternal",
    "compute.autoscalers.create",
    "compute.autoscalers.delete",
    "compute.autoscalers.get",
    "compute.autoscalers.list",
    "compute.autoscalers.update",
    "compute.backendBuckets.get",
    "compute.backendBuckets.list",
    "compute.backendBuckets.listEffectiveTags",
    "compute.backendBuckets.listTagBindings",
    "compute.backendServices.get",
    "compute.backendServices.list",
    "compute.backendServices.listEffectiveTags",
    "compute.backendServices.listTagBindings",
    "compute.disks.addResourcePolicies",
    "compute.disks.create",
    "compute.disks.createSnapshot",
    "compute.disks.createTagBinding",
    "compute.disks.delete",
    "compute.disks.deleteTagBinding",
    "compute.disks.get",
    "compute.disks.getIamPolicy",
    "compute.disks.list",
    "compute.disks.listEffectiveTags",
    "compute.disks.listTagBindings",
    "compute.disks.removeResourcePolicies",
    "compute.disks.resize",
    "compute.disks.setIamPolicy",
    "compute.disks.setLabels",
    "compute.disks.startAsyncReplication",
    "compute.disks.stopAsyncReplication",
    "compute.disks.stopGroupAsyncReplication",
    "compute.disks.update",
    "compute.disks.use",
    "compute.disks.useReadOnly",
    "compute.diskTypes.get",
    "compute.diskTypes.list",
    "compute.externalVpnGateways.get",
    "compute.externalVpnGateways.list",
    "compute.firewalls.get",
    "compute.firewalls.list",
    "compute.firewalls.listEffectiveTags",
    "compute.firewalls.listTagBindings",
    "compute.forwardingRules.get",
    "compute.forwardingRules.list",
    "compute.forwardingRules.listEffectiveTags",
    "compute.forwardingRules.listTagBindings",
    "compute.globalAddresses.get",
    "compute.globalAddresses.list",
    "compute.globalAddresses.use",
    "compute.globalForwardingRules.get",
    "compute.globalForwardingRules.list",
    "compute.globalForwardingRules.listEffectiveTags",
    "compute.globalForwardingRules.listTagBindings",
    "compute.globalForwardingRules.pscGet",
    "compute.globalNetworkEndpointGroups.attachNetworkEndpoints",
    "compute.globalNetworkEndpointGroups.create",
    "compute.globalNetworkEndpointGroups.createTagBinding",
    "compute.globalNetworkEndpointGroups.delete",
    "compute.globalNetworkEndpointGroups.deleteTagBinding",
    "compute.globalNetworkEndpointGroups.detachNetworkEndpoints",
    "compute.globalNetworkEndpointGroups.get",
    "compute.globalNetworkEndpointGroups.list",
    "compute.globalNetworkEndpointGroups.listEffectiveTags",
    "compute.globalNetworkEndpointGroups.listTagBindings",
    "compute.globalNetworkEndpointGroups.use",
    "compute.globalOperations.get",
    "compute.globalOperations.list",
    "compute.healthChecks.get",
    "compute.healthChecks.list",
    "compute.healthChecks.listEffectiveTags",
    "compute.healthChecks.listTagBindings",
    "compute.httpHealthChecks.get",
    "compute.httpHealthChecks.list",
    "compute.httpHealthChecks.listEffectiveTags",
    "compute.httpHealthChecks.listTagBindings",
    "compute.httpsHealthChecks.get",
    "compute.httpsHealthChecks.list",
    "compute.httpsHealthChecks.listEffectiveTags",
    "compute.httpsHealthChecks.listTagBindings",
    "compute.images.create",
    "compute.images.createTagBinding",
    "compute.images.delete",
    "compute.images.deleteTagBinding",
    "compute.images.deprecate",
    "compute.images.get",
    "compute.images.getFromFamily",
    "compute.images.getIamPolicy",
    "compute.images.list",
    "compute.images.listEffectiveTags",
    "compute.images.listTagBindings",
    "compute.images.setIamPolicy",
    "compute.images.setLabels",
    "compute.images.update",
    "compute.images.useReadOnly",
    "compute.instanceGroupManagers.create",
    "compute.instanceGroupManagers.createTagBinding",
    "compute.instanceGroupManagers.delete",
    "compute.instanceGroupManagers.deleteTagBinding",
    "compute.instanceGroupManagers.get",
    "compute.instanceGroupManagers.list",
    "compute.instanceGroupManagers.listEffectiveTags",
    "compute.instanceGroupManagers.listTagBindings",
    "compute.instanceGroupManagers.update",
    "compute.instanceGroupManagers.use",
    "compute.instanceGroups.create",
    "compute.instanceGroups.delete",
    "compute.instanceGroups.get",
    "compute.instanceGroups.list",
    "compute.instanceGroups.update",
    "compute.instanceGroups.use",
    "compute.instances.addAccessConfig",
    "compute.instances.addMaintenancePolicies",
    "compute.instances.addResourcePolicies",
    "compute.instances.attachDisk",
    "compute.instances.create",
    "compute.instances.createTagBinding",
    "compute.instances.delete",
    "compute.instances.deleteAccessConfig",
    "compute.instances.deleteTagBinding",
    "compute.instances.detachDisk",
    "compute.instances.get",
    "compute.instances.getEffectiveFirewalls",
    "compute.instances.getGuestAttributes",
    "compute.instances.getIamPolicy",
    "compute.instances.getScreenshot",
    "compute.instances.getSerialPortOutput",
    "compute.instances.getShieldedInstanceIdentity",
    "compute.instances.getShieldedVmIdentity",
    "compute.instances.list",
    "compute.instances.listEffectiveTags",
    "compute.instances.listReferrers",
    "compute.instances.listTagBindings",
    "compute.instances.osAdminLogin",
    "compute.instances.osLogin",
    "compute.instances.pscInterfaceCreate",
    "compute.instances.removeMaintenancePolicies",
    "compute.instances.removeResourcePolicies",
    "compute.instances.reset",
    "compute.instances.resume",
    "compute.instances.sendDiagnosticInterrupt",
    "compute.instances.setDeletionProtection",
    "compute.instances.setDiskAutoDelete",
    "compute.instances.setIamPolicy",
    "compute.instances.setLabels",
    "compute.instances.setMachineResources",
    "compute.instances.setMachineType",
    "compute.instances.setMetadata",
    "compute.instances.setMinCpuPlatform",
    "compute.instances.setName",
    "compute.instances.setScheduling",
    "compute.instances.setSecurityPolicy",
    "compute.instances.setServiceAccount",
    "compute.instances.setShieldedInstanceIntegrityPolicy",
    "compute.instances.setShieldedVmIntegrityPolicy",
    "compute.instances.setTags",
    "compute.instances.simulateMaintenanceEvent",
    "compute.instances.start",
    "compute.instances.startWithEncryptionKey",
    "compute.instances.stop",
    "compute.instances.suspend",
    "compute.instances.update",
    "compute.instances.updateAccessConfig",
    "compute.instances.updateDisplayDevice",
    "compute.instances.updateNetworkInterface",
    "compute.instances.updateSecurity",
    "compute.instances.updateShieldedInstanceConfig",
    "compute.instances.updateShieldedVmConfig",
    "compute.instances.use",
    "compute.instances.useReadOnly",
    "compute.instanceSettings.get",
    "compute.instanceSettings.update",
    "compute.instanceTemplates.create",
    "compute.instanceTemplates.delete",
    "compute.instanceTemplates.get",
    "compute.instanceTemplates.getIamPolicy",
    "compute.instanceTemplates.list",
    "compute.instanceTemplates.setIamPolicy",
    "compute.instanceTemplates.useReadOnly",
    "compute.instantSnapshots.create",
    "compute.instantSnapshots.delete",
    "compute.instantSnapshots.export",
    "compute.instantSnapshots.get",
    "compute.instantSnapshots.getIamPolicy",
    "compute.instantSnapshots.list",
    "compute.instantSnapshots.setIamPolicy",
    "compute.instantSnapshots.setLabels",
    "compute.instantSnapshots.useReadOnly",
    "compute.interconnectAttachments.get",
    "compute.interconnectAttachments.list",
    "compute.interconnectLocations.get",
    "compute.interconnectLocations.list",
    "compute.interconnectRemoteLocations.get",
    "compute.interconnectRemoteLocations.list",
    "compute.interconnects.get",
    "compute.interconnects.list",
    "compute.licenseCodes.get",
    "compute.licenseCodes.getIamPolicy",
    "compute.licenseCodes.list",
    "compute.licenseCodes.setIamPolicy",
    "compute.licenseCodes.update",
    "compute.licenseCodes.use",
    "compute.licenses.create",
    "compute.licenses.delete",
    "compute.licenses.get",
    "compute.licenses.getIamPolicy",
    "compute.licenses.list",
    "compute.licenses.setIamPolicy",
    "compute.machineImages.create",
    "compute.machineImages.delete",
    "compute.machineImages.get",
    "compute.machineImages.getIamPolicy",
    "compute.machineImages.list",
    "compute.machineImages.setIamPolicy",
    "compute.machineImages.useReadOnly",
    "compute.machineTypes.get",
    "compute.machineTypes.list",
    "compute.networkAttachments.get",
    "compute.networkAttachments.list",
    "compute.networkEndpointGroups.attachNetworkEndpoints",
    "compute.networkEndpointGroups.create",
    "compute.networkEndpointGroups.createTagBinding",
    "compute.networkEndpointGroups.delete",
    "compute.networkEndpointGroups.deleteTagBinding",
    "compute.networkEndpointGroups.detachNetworkEndpoints",
    "compute.networkEndpointGroups.get",
    "compute.networkEndpointGroups.getIamPolicy",
    "compute.networkEndpointGroups.list",
    "compute.networkEndpointGroups.listEffectiveTags",
    "compute.networkEndpointGroups.listTagBindings",
    "compute.networkEndpointGroups.setIamPolicy",
    "compute.networkEndpointGroups.use",
    "compute.networks.get",
    "compute.networks.list",
    "compute.networks.listEffectiveTags",
    "compute.networks.listTagBindings",
    "compute.networks.use",
    "compute.networks.useExternalIp",
    "compute.projects.get",
    "compute.projects.setCommonInstanceMetadata",
    "compute.regionBackendServices.get",
    "compute.regionBackendServices.list",
    "compute.regionBackendServices.listEffectiveTags",
    "compute.regionBackendServices.listTagBindings",
    "compute.regionHealthChecks.get",
    "compute.regionHealthChecks.list",
    "compute.regionHealthChecks.listEffectiveTags",
    "compute.regionHealthChecks.listTagBindings",
    "compute.regionHealthCheckServices.get",
    "compute.regionHealthCheckServices.list",
    "compute.regionNetworkEndpointGroups.attachNetworkEndpoints",
    "compute.regionNetworkEndpointGroups.create",
    "compute.regionNetworkEndpointGroups.createTagBinding",
    "compute.regionNetworkEndpointGroups.delete",
    "compute.regionNetworkEndpointGroups.deleteTagBinding",
    "compute.regionNetworkEndpointGroups.detachNetworkEndpoints",
    "compute.regionNetworkEndpointGroups.get",
    "compute.regionNetworkEndpointGroups.list",
    "compute.regionNetworkEndpointGroups.listEffectiveTags",
    "compute.regionNetworkEndpointGroups.listTagBindings",
    "compute.regionNetworkEndpointGroups.use",
    "compute.regionNotificationEndpoints.get",
    "compute.regionNotificationEndpoints.list",
    "compute.regionOperations.get",
    "compute.regionOperations.list",
    "compute.regions.get",
    "compute.regions.list",
    "compute.regionSslCertificates.get",
    "compute.regionSslCertificates.list",
    "compute.regionSslCertificates.listEffectiveTags",
    "compute.regionSslCertificates.listTagBindings",
    "compute.regionSslPolicies.get",
    "compute.regionSslPolicies.list",
    "compute.regionSslPolicies.listAvailableFeatures",
    "compute.regionTargetHttpProxies.get",
    "compute.regionTargetHttpProxies.list",
    "compute.regionTargetHttpProxies.listEffectiveTags",
    "compute.regionTargetHttpProxies.listTagBindings",
    "compute.regionTargetHttpsProxies.get",
    "compute.regionTargetHttpsProxies.list",
    "compute.regionTargetHttpsProxies.listEffectiveTags",
    "compute.regionTargetHttpsProxies.listTagBindings",
    "compute.regionTargetTcpProxies.get",
    "compute.regionTargetTcpProxies.list",
    "compute.regionUrlMaps.get",
    "compute.regionUrlMaps.list",
    "compute.regionUrlMaps.listEffectiveTags",
    "compute.regionUrlMaps.listTagBindings",
    "compute.reservations.get",
    "compute.reservations.list",
    "compute.resourcePolicies.create",
    "compute.resourcePolicies.delete",
    "compute.resourcePolicies.get",
    "compute.resourcePolicies.getIamPolicy",
    "compute.resourcePolicies.list",
    "compute.resourcePolicies.setIamPolicy",
    "compute.resourcePolicies.update",
    "compute.resourcePolicies.use",
    "compute.resourcePolicies.useReadOnly",
    "compute.routers.get",
    "compute.routers.getRoutePolicy",
    "compute.routers.list",
    "compute.routers.listBgpRoutes",
    "compute.routers.listRoutePolicies",
    "compute.routes.get",
    "compute.routes.list",
    "compute.routes.listEffectiveTags",
    "compute.routes.listTagBindings",
    "compute.serviceAttachments.get",
    "compute.serviceAttachments.list",
    "compute.snapshots.create",
    "compute.snapshots.createTagBinding",
    "compute.snapshots.delete",
    "compute.snapshots.deleteTagBinding",
    "compute.snapshots.get",
    "compute.snapshots.getIamPolicy",
    "compute.snapshots.list",
    "compute.snapshots.listEffectiveTags",
    "compute.snapshots.listTagBindings",
    "compute.snapshots.setIamPolicy",
    "compute.snapshots.setLabels",
    "compute.snapshots.useReadOnly",
    "compute.sslCertificates.get",
    "compute.sslCertificates.list",
    "compute.sslCertificates.listEffectiveTags",
    "compute.sslCertificates.listTagBindings",
    "compute.sslPolicies.get",
    "compute.sslPolicies.list",
    "compute.sslPolicies.listAvailableFeatures",
    "compute.sslPolicies.listEffectiveTags",
    "compute.sslPolicies.listTagBindings",
    "compute.storagePools.get",
    "compute.storagePools.list",
    "compute.storagePools.use",
    "compute.subnetworks.get",
    "compute.subnetworks.list",
    "compute.subnetworks.listEffectiveTags",
    "compute.subnetworks.listTagBindings",
    "compute.subnetworks.use",
    "compute.subnetworks.useExternalIp",
    "compute.targetGrpcProxies.get",
    "compute.targetGrpcProxies.list",
    "compute.targetHttpProxies.get",
    "compute.targetHttpProxies.list",
    "compute.targetHttpProxies.listEffectiveTags",
    "compute.targetHttpProxies.listTagBindings",
    "compute.targetHttpsProxies.get",
    "compute.targetHttpsProxies.list",
    "compute.targetHttpsProxies.listEffectiveTags",
    "compute.targetHttpsProxies.listTagBindings",
    "compute.targetInstances.get",
    "compute.targetInstances.list",
    "compute.targetInstances.listEffectiveTags",
    "compute.targetInstances.listTagBindings",
    "compute.targetPools.get",
    "compute.targetPools.list",
    "compute.targetPools.listEffectiveTags",
    "compute.targetPools.listTagBindings",
    "compute.targetSslProxies.get",
    "compute.targetSslProxies.list",
    "compute.targetSslProxies.listEffectiveTags",
    "compute.targetSslProxies.listTagBindings",
    "compute.targetTcpProxies.get",
    "compute.targetTcpProxies.list",
    "compute.targetTcpProxies.listEffectiveTags",
    "compute.targetTcpProxies.listTagBindings",
    "compute.targetVpnGateways.get",
    "compute.targetVpnGateways.list",
    "compute.urlMaps.get",
    "compute.urlMaps.list",
    "compute.urlMaps.listEffectiveTags",
    "compute.urlMaps.listTagBindings",
    "compute.vpnGateways.get",
    "compute.vpnGateways.list",
    "compute.vpnTunnels.get",
    "compute.vpnTunnels.list",
    "compute.zoneOperations.get",
    "compute.zoneOperations.list",
    "compute.zones.get",
    "compute.zones.list",
    "firebase.projects.get",
    "iam.serviceAccounts.actAs",
    "iam.serviceAccounts.get",
    "iam.serviceAccounts.getAccessToken",
    "iam.serviceAccounts.getOpenIdToken",
    "iam.serviceAccounts.implicitDelegation",
    "iam.serviceAccounts.list",
    "iam.serviceAccounts.signBlob",
    "iam.serviceAccounts.signJwt",
    "orgpolicy.policy.get",
    "recommender.iamPolicyInsights.get",
    "recommender.iamPolicyInsights.list",
    "recommender.iamPolicyInsights.update",
    "recommender.iamPolicyRecommendations.get",
    "recommender.iamPolicyRecommendations.list",
    "recommender.iamPolicyRecommendations.update",
    "resourcemanager.hierarchyNodes.listEffectiveTags",
    "resourcemanager.projects.get",
    "secretmanager.versions.access",
    "serviceusage.quotas.get",
    "serviceusage.services.get",
    "serviceusage.services.list",
    "storage.anywhereCaches.create",
    "storage.anywhereCaches.disable",
    "storage.anywhereCaches.get",
    "storage.anywhereCaches.list",
    "storage.anywhereCaches.pause",
    "storage.anywhereCaches.resume",
    "storage.anywhereCaches.update",
    "storage.bucketOperations.cancel",
    "storage.bucketOperations.get",
    "storage.bucketOperations.list",
    "storage.buckets.create",
    "storage.buckets.createTagBinding",
    "storage.buckets.delete",
    "storage.buckets.deleteTagBinding",
    "storage.buckets.enableObjectRetention",
    "storage.buckets.get",
    "storage.buckets.getIamPolicy",
    "storage.buckets.getObjectInsights",
    "storage.buckets.list",
    "storage.buckets.listEffectiveTags",
    "storage.buckets.listTagBindings",
    "storage.buckets.restore",
    "storage.buckets.setIamPolicy",
    "storage.buckets.update",
    "storage.managedFolders.create",
    "storage.managedFolders.delete",
    "storage.managedFolders.get",
    "storage.managedFolders.getIamPolicy",
    "storage.managedFolders.list",
    "storage.managedFolders.setIamPolicy",
    "storage.multipartUploads.abort",
    "storage.multipartUploads.create",
    "storage.multipartUploads.list",
    "storage.multipartUploads.listParts",
    "storage.objects.create",
    "storage.objects.delete",
    "storage.objects.get",
    "storage.objects.getIamPolicy",
    "storage.objects.list",
    "storage.objects.overrideUnlockedRetention",
    "storage.objects.restore",
    "storage.objects.setIamPolicy",
    "storage.objects.setRetention",
    "storage.objects.update",
  ]
}

resource "google_project_iam_member" "cloud_run_service_assign_role" {
  count      = local.ready_to_deploy_iam ? 1 : 0
  project    = var.gcp_project_id
  role       = "projects/${var.gcp_project_id}/roles/${google_project_iam_custom_role.cloud_run_service_account_role[0].role_id}"
  member     = "serviceAccount:cloudrun-service-account@${var.gcp_project_id}.iam.gserviceaccount.com"
  depends_on = [module.iam-sa]
}

# Additional permissions for the GitLab service account that don't fit into one of GCP's pre-defined roles
resource "google_project_iam_custom_role" "gitlab_tf_service_account_role" {
  count       = local.ready_to_deploy_iam ? 1 : 0
  role_id     = local.gitlab_custom_role_name
  title       = "GitLab Terraform Custom Service Account Role"
  description = "Custom role for the GitLab service account to run terraform"
  permissions = [
    "artifactregistry.projectsettings.update",
    "artifactregistry.repositories.create",
    "artifactregistry.repositories.createTagBinding",
    "artifactregistry.repositories.delete",
    "artifactregistry.repositories.deleteTagBinding",
    "artifactregistry.repositories.getIamPolicy",
    "artifactregistry.repositories.setIamPolicy",
    "artifactregistry.repositories.update",
    "cloudsql.backupRuns.delete",
    "cloudsql.databases.delete",
    "cloudsql.instances.clone",
    "cloudsql.instances.create",
    "cloudsql.instances.createTagBinding",
    "cloudsql.instances.delete",
    "cloudsql.instances.deleteTagBinding",
    "cloudsql.instances.demoteMaster",
    "cloudsql.instances.executeSql",
    "cloudsql.instances.import",
    "cloudsql.instances.login",
    "cloudsql.instances.promoteReplica",
    "cloudsql.instances.resetSslConfig",
    "cloudsql.instances.restoreBackup",
    "cloudsql.instances.startReplica",
    "cloudsql.instances.stopReplica",
    "cloudsql.sslCerts.create",
    "cloudsql.sslCerts.delete",
    "cloudsql.users.create",
    "cloudsql.users.delete",
    "cloudsql.users.update",
    "iam.roles.create",
    "iam.roles.delete",
    "iam.roles.undelete",
    "iam.roles.update",
    "iam.serviceAccounts.create",
    "iam.serviceAccounts.delete",
    "iam.serviceAccounts.disable",
    "iam.serviceAccounts.enable",
    "iam.serviceAccounts.implicitDelegation",
    "iam.serviceAccounts.setIamPolicy",
    "iam.serviceAccounts.signJwt",
    "iam.serviceAccounts.undelete",
    "iam.serviceAccounts.update",
    "networkmanagement.config.get",
    "networkmanagement.config.startFreeTrial",
    "networkmanagement.config.update",
    "networkmanagement.connectivitytests.create",
    "networkmanagement.connectivitytests.delete",
    "networkmanagement.connectivitytests.getIamPolicy",
    "networkmanagement.connectivitytests.rerun",
    "networkmanagement.connectivitytests.setIamPolicy",
    "networkmanagement.connectivitytests.update",
    "networkmanagement.locations.get",
    "networkmanagement.locations.list",
    "networkmanagement.operations.cancel",
    "networkmanagement.operations.delete",
    "networkmanagement.operations.get",
    "networkmanagement.operations.list",
    "networkmanagement.topologygraphs.read",
    "pubsub.subscriptions.create",
    "pubsub.subscriptions.delete",
    "pubsub.subscriptions.get",
    "pubsub.subscriptions.list",
    "pubsub.topics.attachSubscription",
    "pubsub.topics.create",
    "pubsub.topics.delete",
    "pubsub.topics.get",
    "pubsub.topics.list",
    "pubsub.topics.publish",
    "recommender.cloudsqlInstanceSecurityInsights.get",
    "recommender.cloudsqlInstanceSecurityInsights.list",
    "recommender.cloudsqlInstanceSecurityInsights.update",
    "recommender.cloudsqlInstanceSecurityRecommendations.get",
    "recommender.cloudsqlInstanceSecurityRecommendations.list",
    "recommender.cloudsqlInstanceSecurityRecommendations.update",
    "redis.clusters.connect",
    "redis.clusters.create",
    "redis.clusters.delete",
    "redis.instances.create",
    "redis.instances.createTagBinding",
    "redis.instances.delete",
    "redis.instances.deleteTagBinding",
    "redis.instances.export",
    "redis.instances.getAuthString",
    "redis.instances.import",
    "redis.instances.listEffectiveTags",
    "redis.instances.listTagBindings",
    "redis.instances.rescheduleMaintenance",
    "redis.instances.updateAuth",
    "redis.instances.upgrade",
    "run.jobs.createTagBinding",
    "run.jobs.deleteTagBinding",
    "run.jobs.setIamPolicy",
    "run.services.createTagBinding",
    "run.services.deleteTagBinding",
    "run.services.setIamPolicy",
  ]
}
